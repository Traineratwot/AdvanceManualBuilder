{"version":3,"names":[],"mappings":"","sources":["assets/projects/AdvanceManualBuilder/core/js/layout.class.js"],"sourcesContent":["class LayoutEditorClass {\r\n\tconstructor() {\r\n\t\tthis.block = $('#editor')\r\n\t\tthis.modal = $('#editorModal')\r\n\t\tthis.template = new CLASSES.Template()\r\n\t\tthis.addModal = $('#addModal')\r\n\t\tthis.addModals = {}\r\n\t\tfor(const CLASSESKey in CLASSES) {\r\n\t\t\tthis.addModal.find('select').append($(editorTemplate.get('option', {\r\n\t\t\t\tlabel: CLASSESKey,\r\n\t\t\t\tvalue: CLASSESKey,\r\n\t\t\t})))\r\n\t\t}\r\n\r\n\t\tthis.modals = {}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @param  {ManualClass} manual\r\n\t */\r\n\trender(elem = {}) {\r\n\t\tthis.block.html('')\r\n\t\tthis.elem = elem\r\n\t\tif(elem instanceof CLASSES.CommonClass) {\r\n\t\t\telem.editorRender({\r\n\t\t\t\tparent: this.block,\r\n\t\t\t\tcaller: 'create'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass LayoutTreeClass {\r\n\tconstructor() {\r\n\t\tthis.block = $('#tree')\r\n\t}\r\n\r\n\r\n\trender() {\r\n\t\tthis.block.html('')\r\n\t\tthis.renderTree()\r\n\t}\r\n\r\n\r\n\trenderTree() {\r\n\t\tthis.tree = $(treeTemplate.get('main', {text: 'Manuals'})).appendTo(this.block)\r\n\t\tif(typeof manuals != 'undefined' && manuals instanceof Object) {\r\n\t\t\tfor(const key in manuals.index) {\r\n\t\t\t\tif(manuals.index.hasOwnProperty(key)) {\r\n\t\t\t\t\tconst manual = manuals.index[key]\r\n\t\t\t\t\tmanual.renderTree(this.tree)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t$(treeTemplate.get('add', {\r\n\t\t\ttext: 'add manual',\r\n\t\t\tclasskey: 'ManualClass',\r\n\t\t\ttreeIcon: 'diff-added'\r\n\t\t})).appendTo(this.tree)\r\n\r\n\t\tthis.treeEvent()\r\n\t}\r\n\r\n\r\n\ttreeEvent() {\r\n\t\t$('.caret:not(\"caret-down\")').each(function() {\r\n\t\t\tif(GOA[$(this).data('object')].treeOpened) {\r\n\t\t\t\t$(this).toggleClass('caret-down').find('+ .nested').slideToggle()\r\n\t\t\t}\r\n\t\t})\r\n\t\t$('.caret').on('nondblclick', function() {\r\n\t\t\t$(this).toggleClass('caret-down').find('+ .nested').slideToggle()\r\n\t\t\tGOA[$(this).data('object')].treeOpenedToggle()\r\n\t\t})\r\n\t\t$('button.startEditor').each(function() {\r\n\t\t\tEMC.add({\r\n\t\t\t\telement: this,\r\n\t\t\t\tevent: 'dblclick',\r\n\t\t\t\tfunc: 'treeDblclick',\r\n\t\t\t})\r\n\t\t})\r\n\t\t$('button.addElem').each(function() {\r\n\t\t\tEMC.add({\r\n\t\t\t\telement: this,\r\n\t\t\t\tevent: 'dblclick',\r\n\t\t\t\tfunc: 'treeAddDblclick',\r\n\t\t\t})\r\n\t\t})\r\n\t\t$('button.caret').each(function() {\r\n\t\t\tvar v = $(this).siblings('ul').length\r\n\t\t\tif(v > 0) {\r\n\t\t\t\t$(this).removeClass('empty')\r\n\t\t\t} else {\r\n\t\t\t\t$(this).addClass('empty')\r\n\r\n\t\t\t}\r\n\t\t})\r\n\t\tEMC.setEvents()\r\n\t\ttmp.trash()\r\n\t}\r\n}\r\n\r\nclass layoutPreviewClass {\r\n\tconstructor() {\r\n\t\tthis.block = $(window.frames[0].document.body).find('div#wrap')\r\n\t\tthis.terminal = window.frames[0]\r\n\t\tthis.markdown = []\r\n\t\tthis.text = ''\r\n\t}\r\n\tadd(text){\r\n\t\tthis.markdown.push(`\\n\\r${text}\\n\\r`)\r\n\t\tthis.text = this.markdown.join(\"\\n\\r***\\n\\r\")\r\n\t}\r\n\tclear(){\r\n\t\tthis.markdown = []\r\n\t\tthis.text = ''\r\n\t}\r\n\trender(){\r\n\t\tif(this.block.length == 0){\r\n\t\t\tthis.block = $(window.frames[0].document.body).find('div#wrap')\r\n\t\t}\r\n\t\tthis.block.html(this.text)\r\n\t\tthis.terminal.convert()\r\n\t\treturn this.markdown\r\n\t}\r\n}\r\n\r\nlayout.editor = new LayoutEditorClass()\r\nlayout.preview = new layoutPreviewClass()\r\nlayout.tree = new LayoutTreeClass()\r\nlayout.editor.template.addModal = `<div class=\"modal fade\" id=\"$[GlobalKey]_addModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalCenterTitle\"\r\n\t     aria-hidden=\"true\">\r\n\t    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\r\n\t        <div class=\"modal-content\">\r\n\t            <div class=\"modal-header\">\r\n\t                <h5 class=\"modal-title\">$[header]</h5>\r\n\t                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n\t                    <span aria-hidden=\"true\">&times;</span>\r\n\t                </button>\r\n\t            </div>\r\n\t            <div class=\"modal-body\">\r\n\t                <div class=\"input-group mb-3\">\r\n\t                    <div class=\"input-group-prepend\">\r\n\t                        <label class=\"input-group-text\" for=\"inputGroupSelect01\">${locale._('object')}</label>\r\n\t                    </div>\r\n\t                    <select data-object=\"$[GlobalKey]\" class=\"custom-select\" id=\"inputGroupSelect01\">\r\n\t                        <option selected>${locale._('chose')}</option>\r\n\t                    </select>\r\n\t                </div>\r\n\t            </div>\r\n\t            <div class=\"modal-footer\">\r\n\t                <button type=\"button\" class=\"btn btn-secondary\" \t\t\tdata-dismiss=\"modal\">${locale._('close')}</button>\r\n\t                <button type=\"button\" class=\"btn btn-primary createElem\"  \tdata-dismiss=\"modal\">${locale._('create')}<i></i></button>\r\n\t            </div>\r\n\t        </div>\r\n\t    </div>\r\n\t</div>`\r\nlayout.tree.render()\r\n\r\n\r\n"],"file":"layout.class.js"}